var Bind=function e(n){"use strict";if(!Function.bind||!Object.defineProperty)throw Error("Prerequisite APIs not available.");var t=[],r=Array.isArray,i="object",a=function(e){return e},c=function(e){return function(){try{return e.apply(this,arguments)}catch(n){console.error(n.stack?n.stack:n)}}};function o(e){return(e+"").replace(/[<>]/g,function(e){return({">":"&gt;","<":"&lt;"})[e]})}function l(e,n){for(var t=e.length,r=0;r<t;r++)n(e[r],r,e)}function u(e,n){l("pop push reverse shift sort splice unshift".split(" "),(function r(i){this[i]=(function r(){this.__dirty=!0;var a=f({},t[i].apply(this,arguments));return delete this.__dirty,e&&n.ready&&e(this),a}).bind(this)}).bind(this));var r=this.length;return Object.defineProperty(this,"length",{configurable:!1,enumerable:!0,set:function(e){if(this.__dirty){r=e;return}var n=1*e;return r!==n&&(n>r?this.push.apply(this,Array(n-r)):this.splice(n),r=n),e},get:function(){return r}}),this}function f(n,t){return t instanceof Object?(l(Object.getOwnPropertyNames(t),function(a){var c=t[a];!e.prototype[a]&&"__callback"!==a&&(typeof c===i&&null!==c&&c instanceof Array?n[a]=[].map.call(c,function(e){return e instanceof Object?f(n[a]||{},e):e}):typeof c!==i||null===c||r(c)||"[Object object]"!==c.toString()?n[a]=c:n[a]=f(n[a]||{},c))}),n):t}function e(t,s,h){if(!this||this===n)return new e(t,s,h);var p={context:h||n.document,mapping:s||{},callbacks:{},deferred:[],ready:!1,instance:this};return!function t(s,h,p,d){if(d||(d=[]),p.ready&&h.__callback)return s;if(h instanceof e)return h;try{var y,v=p.context||document;y=v.querySelectorAll.bind(v)}catch(b){}return l(Object.getOwnPropertyNames(h),function e(v){if("__callback"!==v){var b,k,g=h[v],m=[].slice.call(d),$=function(e){return"string"==typeof e?o(e):e},E=a;m.push(v);var _=p.mapping[m.join(".")];if(_&&"[object Object]"===_.toString()&&(_.callback&&(b=_.callback),_.transform&&($=c(_.transform.bind({safe:o}))),_.parse&&(E=c(_.parse)),_=_.dom),"string"==typeof _?k=y(_||"☺"):n.Element&&_ instanceof n.Element&&(k=[_]),"function"==typeof _)b=_;else if(k){0===k.length&&console.warn('No elements found against "'+_+'" selector');var P=["SELECT","INPUT","PROGRESS","TEXTAREA"];null==g&&(g=-1!==P.indexOf(k[0].nodeName)?k[0].hasOwnProperty("checked")?E("on"===k[0].value?k[0].checked:k[0].value):E(k[0].value):E(k[0].innerHTML));var T=b;b=function(e){(k=y(_||"☺"))&&l(k,function(n){if(!n.__dirty){if(-1!==P.indexOf(n.nodeName)){var t=$(e,s);if("checkbox"===n.type)t instanceof Array?0===t.filter(function(e){if(e===n.value)return n.checked=n.value===e,!0}).length&&(n.checked=!1):"boolean"==typeof t&&(n.checked=t);else if("radio"===n.type)n.checked=n.value===t;else if("number"==typeof n.value)try{n.value=1*t}catch(r){console.error(r.message)}else n.value=t}else{e instanceof Array||(e=[e]);var i=[];l(e,function(e){i.push($(e,s))}),"object"==typeof i[0]?(n.innerHTML="",i.forEach(function(e){n.appendChild(e)})):n.innerHTML=i.join("")}}}),T&&T.apply(s,arguments)},l(k,function(e){if("INPUT"===e.nodeName||"SELECT"===e.nodeName||"TEXTAREA"===e.nodeName){var n=function(){if(this.__dirty=!0,"checkbox"===e.type){var n,t=(e.form||document).querySelectorAll('input[name="'+e.name+'"][type="checkbox"]');if(s[v]instanceof Array){var r=[];l(t,function(e){e.checked&&r.push(E("on"===e.value?e.checked:e.value))}),n=r}else n=E("on"===this.value?this.checked:this.value)}else"radio"===e.type&&(n=E("on"===this.value?this.checked:this.value)),n="number"==typeof s[v]?E(1*this.value):E(this.value);void 0===n&&(n=this.value),s[v]=n,this.__dirty=!1},t={checkbox:"change",radio:"change"}[e.type];e.addEventListener(t||"input",n)}})}b&&m.reduce(function(e,n,t,r){return e[n]||(e[n]={}),t===r.length-1&&(e[n].__callback=b),e[n]},p.callbacks);var j=function e(n){var t=[],r=[],i=p.instance,a=!1,c=!1;m.reduce(function(e,o,l){if(e&&e[o]&&o){if(null===(i=i[o])||void 0===i)return e[o]||{};if("function"==typeof e[o].__callback){var u=l===m.length-1?n:i;i.__dirty&&(a=!0),l===m.length-1&&e[o].__callback&&(c={path:m.join("."),callback:e[o].__callback,instance:u}),a||(r.push(f(u instanceof Array?[]:{},u)),t.push(e[o].__callback))}return e[o]||{}}},p.callbacks),a||(r.reverse(),t.reverse().forEach(function(e,n){e.call(p.instance,r[n])})),a&&c&&(i=c.instance,c.callback.call(p.instance,f(i instanceof Array?[]:{},i)))};try{Object.defineProperty(s,v,{configurable:!0,enumerable:!0,set:function(e){var n=g!==e?g:void 0;g=!p.ready||typeof e!==i||null===e||r(e)||e.__callback?r(e)?t(new u(j,p),e,p,m):e:t(s[v]?f({},s[v]):{},e,p,m),p.ready?j(g):void 0!==p.mapping[m.join(".")]&&p.deferred.push(j.bind(s,g,n))},get:function(){return g}})}catch(x){}typeof g!==i||null===g||r(g)?r(g)?s[v]=t(new u(j,p),g,p,m):s instanceof u||(s[v]=g):s[v]=t(s[v]||{},g,p,m)}}),s instanceof u&&s.push.apply(s,h),s}(this,t,p),p.ready=!0,p.deferred.length&&l(p.deferred,function(e){e()}),this}return u.prototype=[],e.prototype.__export=function(){return f({},this)},e}(window);"undefined"!=typeof exports&&(module.exports=Bind);